version: 2

models:
# Orders table
  - name: raw_order
    columns:
      # OrderID - Unique, Not Null
      - name: OrderID
        tests:
          - unique
          - not_null
      # CustomerID - Not Null, Valid foreign key ref
      - name: CustomerID
        tests:
          - not_null
          - relationships:
              to: ref('raw_customer')
              field: CustomerID
      # EmployeeID - Not Null, Valid foreign key ref
      - name: EmployeeID
        tests:  
          - not_null
          - relationships:
              to: ref('raw_employee')
              field: EmployeeID
      # orderDate - Not Null
      - name: orderDate
        tests:  
          - not_null
      # requiredDate - Not Null
      - name: requiredDate
        tests:  
          - not_null
      # shipVia - Not Null, Valid foreign key ref
      - name: shipVia
        tests:  
          - relationships:
              to: ref('raw_shipper')
              field: ShipperID
      # freight - check singular test "test_raw_order_freight_is_positive.sql"
      # shipName - Not Null, Does not contain "NULL" string
      - name: shipName
        tests:  
          - dbt_utils.not_accepted_values:
              values: ['NULL']
      # shipAddress - Not Null, Does not contain "NULL" string
      - name: shipAddress
        tests:  
          - dbt_utils.not_accepted_values:
              values: ['NULL']
      # shipCity - Not Null, Does not contain "NULL" string
      - name: shipCity
        tests:  
          - dbt_utils.not_accepted_values:
              values: ['NULL']
      # shipRegion - Not Null, Does not contain "NULL" string
      - name: shipRegion
        tests:  
          - dbt_utils.not_accepted_values:
              values: ['NULL']
      # shipPostalCode - Not Null, Does not contain "NULL" string
      - name: shipPostalCode
        tests:  
          - dbt_utils.not_accepted_values:
              values: ['NULL']
      # shipPostalCode - Not Null, Does not contain "NULL" string
      - name: shipCountry
        tests:  
          - dbt_utils.not_accepted_values:
              values: ['NULL']
        
# OrderDetail table

# Shipper table
  - name: raw_shipper
    columns:
      - name: ShipperID

# Employee table
  - name: raw_employee
    columns:
      - name: EmployeeID
        tests: 
          - unique
          - not_null 

# EmployeeTerritory
  - name: raw_employeeterritory
    columns:
      - name: surrogate_key
        tests:
          - unique
          - not_null

# Territory table
  - name: raw_territory
    columns:
      - name: TerritoryID
        tests: 
          - unique
          - not_null 

      - name: RegionID 
        tests:
        - not_null

# Region table
  - name: raw_region
    columns:
      - name: RegionID
        tests:
          - unique
          - not_null

# Product table
  - name: raw_product
    columns:
      - name: productID
        tests:
          - unique
          - not_null
      - name: supplierID
        tests: 
          - not_null
          - relationships:
              to: ref('raw_supplier')
              field: supplierID
      - name: categoryID
        tests:
          - not_null
          - relationships:
              to: ref('raw_category')
              field: categoryID
      - name: quantityPerUnit
        tests:
          - not_null
      - name: unitPrice
        tests:
          - not_null
      - name: unitsInStock
        tests:
          - not_null
      - name: discontinued
        tests:
          - accepted_values:
              values: ['true', 'false']

# Category table
  - name: raw_category
    columns:
      - name: categoryID
        tests:
        - unique
        - not_null
      - name: categoryName
        tests:
        - not_null
